/**
 * Copyright 2014 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

!function(e,define){define(["./kendo.list.min","./kendo.mobile.scroller.min"],e)}(function(){return function(e,t){var n=window.kendo,i=n.ui,a=i.List,s=i.Select,r=n.caret,o=n.support,l=o.placeholder,c=n._activeElement,u=n.keys,d=".kendoComboBox",h="click"+d,f="mousedown"+d,p="disabled",g="readonly",v="change",_="k-state-default",m="k-state-focused",b="k-state-disabled",C="aria-disabled",k="aria-readonly",y="k-state-selected",w="filter",F="accept",x="rebind",S="mouseenter"+d+" mouseleave"+d,D=null,T=e.proxy,I=s.extend({init:function(t,i){var a,r=this;r.ns=d,i=e.isArray(i)?{dataSource:i}:i,s.fn.init.call(r,t,i),i=r.options,t=r.element.on("focus"+d,T(r._focusHandler,r)),i.placeholder=i.placeholder||t.attr("placeholder"),r._reset(),r._wrapper(),r._input(),r._tabindex(r.input),r._popup(),r._dataSource(),r._ignoreCase(),r._enable(),r._oldIndex=r.selectedIndex=-1,r._cascade(),r._aria(),i.autoBind?r._filterSource():(a=i.text,!a&&r._isSelect&&(a=t.children(":selected").text()),a&&(r.input.val(a),r._prev=a)),a||r._placeholder(),n.notify(r)},options:{name:"ComboBox",enabled:!0,index:-1,text:null,value:null,autoBind:!0,delay:200,dataTextField:"",dataValueField:"",minLength:0,height:200,highlightFirst:!0,template:"",filter:"none",placeholder:"",suggest:!1,cascadeFrom:"",cascadeFromField:"",ignoreCase:!0,animation:{}},events:["open","close",v,"select","dataBinding","dataBound","cascade"],setOptions:function(e){s.fn.setOptions.call(this,e),this._template(),this._accessors(),this._aria()},current:function(e){var n=this,i=n._current;return e===t?i:(i&&i.removeClass(y),s.fn.current.call(n,e),t)},destroy:function(){var e=this;e.input.off(d),e.element.off(d),e._inputWrapper.off(d),s.fn.destroy.call(e)},_focusHandler:function(){this.input.focus()},_arrowClick:function(){this._toggle()},_inputFocus:function(){this._inputWrapper.addClass(m),this._placeholder(!1)},_inputFocusout:function(){var e=this;e._inputWrapper.removeClass(m),clearTimeout(e._typing),e._typing=null,e.options.text!==e.input.val()&&e.text(e.text()),e._placeholder(),e._blur(),e.element.blur()},_editable:function(e){var t=this,n=e.disable,i=e.readonly,a=t._inputWrapper.off(d),s=t.element.add(t.input.off(d)),r=t._arrow.parent().off(h+" "+f);i||n?(a.addClass(n?b:_).removeClass(n?_:b),s.attr(p,n).attr(g,i).attr(C,n).attr(k,i)):(a.addClass(_).removeClass(b).on(S,t._toggleHover),s.removeAttr(p).removeAttr(g).attr(C,!1).attr(k,!1),r.on(h,T(t._arrowClick,t)).on(f,function(e){e.preventDefault()}),t.input.on("keydown"+d,T(t._keydown,t)).on("focus"+d,T(t._inputFocus,t)).on("focusout"+d,T(t._inputFocusout,t)))},open:function(){var e=this,t=e.dataSource.options.serverFiltering;e.popup.visible()||(!e.ul[0].firstChild||e._state===F&&!t?(e._open=!0,e._state=x,e._filterSource()):(e.popup.open(),e._scroll(e._current)))},refresh:function(){var i,a,s=this,r=s.ul[0],o=s.options,l=s._state,u=s._data(),d=u.length,h=!0;s._angularItems("cleanup"),s.trigger("dataBinding"),r.innerHTML=n.render(s.template,u),s._height(d),s.popup.visible()&&s.popup._position(),s._isSelect&&(i=s.element[0].children[0],l===x&&(s._state=""),a=s._option,s._option=t,s._options(u),a&&a[0].selected?s._custom(a.val(),h):s._bound||i||s._custom("",h)),d&&(o.highlightFirst&&s.current(e(r.firstChild)),o.suggest&&s.input.val()&&s._request!==t&&s.suggest(e(r.firstChild))),l===w||s._fetch||s._selectItem(),s._open&&(s._open=!1,s._typing&&s.input[0]!==c()?s.popup.close():s.toggle(!!d),s._typing=null),s._touchScroller&&s._touchScroller.reset(),s._makeUnselectable(),s._hideBusy(),s._bound=!0,s._angularItems("compile"),s.trigger("dataBound")},suggest:function(e){var n,i=this,s=i.input[0],o=i.text(),l=r(s)[0],d=i._last;return d==u.BACKSPACE||d==u.DELETE?(i._last=t,t):(e=e||"","string"!=typeof e&&(n=a.inArray(e[0],i.ul[0]),e=n>-1?i._text(i.dataSource.view()[n]):""),0>=l&&(l=o.toLowerCase().indexOf(e.toLowerCase())+1),e?(n=e.toLowerCase().indexOf(o.toLowerCase()),n>-1&&(o+=e.substring(n+o.length))):o=o.substring(0,l),o.length===l&&e||(s.value=o,s===c()&&r(s,l,o.length)),t)},text:function(e){var n,i,a,s,r,o;return e=null===e?"":e,n=this,i=n.input[0],a=n.options.ignoreCase,s=e,e===t?i.value:(r=n.dataItem(),r&&n._text(r)===e&&(o=n._value(r),null===o?o="":o+="",o===n._old)?(n._triggerCascade(),t):(a&&(s=s.toLowerCase()),n._select(function(e){return e=n._text(e),a&&(e=(e+"").toLowerCase()),e===s}),0>n.selectedIndex&&(n._custom(e),i.value=e),n._prev=i.value,n._triggerCascade(),t))},toggle:function(e){this._toggle(e,!0)},value:function(e){var n,i=this,a=i.options;return e===t?i._accessor():(null!==e&&(e=""+e),i._selectedValue=e,!i._open&&e&&i._fetchItems(e)||(n=i._index(e),n>-1?i.select(n):(i.current(D),i._custom(e),(a.value!==e||a.text!==i.input.val())&&(i.text(e),i._placeholder())),i._old=i._accessor(),i._oldIndex=i.selectedIndex),t)},_accept:function(e){var t=this;e?t._focus(e):(t.text(t.text()),t._change())},_custom:function(t,n){var i=this,a=i.element,s=i._option;i._state!==w||n||(i._state=F),i._isSelect?(s||(s=i._option=e("<option/>"),a.append(s)),s.text(t),s[0].selected=!0):a.val(t),i._selectedValue=t},_filter:function(e){var n=this,i=n.options,a=n.dataSource,s=i.ignoreCase,r=function(i){var a=n._text(i);return a!==t?(a+="",""!==a&&""===e?!1:(s&&(a=a.toLowerCase()),0===a.indexOf(e))):t};return s&&(e=e.toLowerCase()),n.ul[0].firstChild?(-1!==n._highlight(r)&&(i.suggest&&n._current&&n.suggest(n._current),n.open()),n._hideBusy(),t):(a.one(v,function(){a.data()[0]&&n.search(e)}).fetch(),t)},_highlight:function(n){var i,s=this;return n===t||null===n?-1:(n=s._get(n),i=a.inArray(n[0],s.ul[0]),-1==i&&(s.options.highlightFirst&&!s.text()?(n=s.ul[0].firstChild,n&&(n=e(n))):n=D),s.current(n),i)},_input:function(){var t,n=this,i=n.element.removeClass("k-input")[0],a=i.accessKey,s=n.wrapper,r="input.k-input",o=i.name||"";o&&(o='name="'+o+'_input" '),t=s.find(r),t[0]||(s.append('<span tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default"><input '+o+'class="k-input" type="text" autocomplete="off"/><span tabindex="-1" unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(n.element),t=s.find(r)),t[0].style.cssText=i.style.cssText,i.maxLength>-1&&(t[0].maxLength=i.maxLength),t.addClass(i.className).val(this.options.text||i.value).css({width:"100%",height:i.style.height}).attr({role:"combobox","aria-expanded":!1}).show(),l&&t.attr("placeholder",n.options.placeholder),a&&(i.accessKey="",t[0].accessKey=a),n._focused=n.input=t,n._inputWrapper=e(s[0].firstChild),n._arrow=s.find(".k-icon").attr({role:"button",tabIndex:-1}),i.id&&n._arrow.attr("aria-controls",n.ul[0].id)},_keydown:function(e){var t=this,n=e.keyCode;t._last=n,clearTimeout(t._typing),t._typing=null,n==u.TAB||t._move(e)||t._search()},_placeholder:function(e){if(!l){var n,i=this,a=i.input,s=i.options.placeholder;if(s){if(n=i.value(),e===t&&(e=!n),a.toggleClass("k-readonly",e),!e){if(n)return;s=""}a.val(s),s||a[0]!==c()||r(a[0],0,0)}}},_search:function(){var e=this;e._typing=setTimeout(function(){var t=e.text();e._prev!==t&&(e._prev=t,e.search(t)),e._typing=null},e.options.delay)},_select:function(e){var n,i,a=this,s=a._data(),r=a._highlight(e);a.selectedIndex=r,-1!==r&&(a._state===w&&(a._state=F),a._current.addClass(y),s=s[r],n=a._text(s),i=a._value(s),null===i&&(i=""),a._prev=a.input[0].value=n,a._accessor(i!==t?i:n,r),a._selectedValue=a._accessor(),a._placeholder(),a._optionID&&a._current.attr("aria-selected",!0))},_wrapper:function(){var e=this,t=e.element,n=t.parent();n.is("span.k-widget")||(n=t.hide().wrap("<span />").parent(),n[0].style.cssText=t[0].style.cssText),e.wrapper=n.addClass("k-widget k-combobox k-header").addClass(t[0].className).css("display","")},_clearSelection:function(e,t){var n=this,i=e._selectedValue||e.value(),a=i&&-1===e.selectedIndex;(t||!i||a)&&(n.value(""),n.options.value="")}});i.plugin(I)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});